Mon 19 Jan 2026 02:35:15 INFO  {'seed': 2020, 'dataset': 'Industrial_and_Scientific', 'bidirectional': False, 'n_heads': 2, 'lr': 0.0005, 'tau': 0.07, 'cl_weight': 0.4, 'mlm_weight': 0.2, 'neg_num': 25000, 'text_types': ['title', 'brand', 'features', 'categories', 'description'], 'epochs': 500, 'batch_size': 100, 'num_workers': 8, 'eval_step': 1, 'learner': 'AdamW', 'data_path': './dataset', 'map_path': '.emb_map.json', 'text_index_path': '.code.pq.20_256.pca128.title_brand_features_categories_description.json', 'text_emb_path': '.t5.meta.emb.npy', 'lr_scheduler_type': 'constant', 'gradient_accumulation_steps': 1, 'warmup_steps': 500, 'weight_decay': 0.0001, 'max_his_len': 50, 'n_codes_per_lel': 256, 'code_level': 20, 'early_stop': 100, 'embedding_size': 128, 'hidden_size': 512, 'n_layers': 2, 'n_layers_cross': 2, 'dropout_prob': 0.4, 'dropout_prob_cross': 0.1, 'mask_ratio': 0.5, 'device': 'cuda:0', 'metrics': 'recall@5,ndcg@5,recall@10,ndcg@10', 'valid_metric': 'ndcg@10', 'log_dir': './logs/Industrial_and_Scientific/分析_时间为一个月', 'ckpt_dir': './myckpt/', 'resume': None, 'run_local_time': 'Jan-19-2026_02-35', 'save_file_name': 'Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1'}
Mon 19 Jan 2026 02:35:40 INFO  MGFSRec(
  (query_code_embedding): Embedding(5121, 128, padding_idx=0)
  (item_text_embedding): ModuleList(
    (0-4): 5 x Embedding(25849, 128, padding_idx=0)
  )
  (qformer): CrossAttTransformer(
    (layer): ModuleList(
      (0-1): 2 x CrossAttTransformerLayer(
        (self_attention): MultiHeadAttention(
          (query): Linear(in_features=128, out_features=128, bias=True)
          (key): Linear(in_features=128, out_features=128, bias=True)
          (value): Linear(in_features=128, out_features=128, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (out_linear): Linear(in_features=128, out_features=128, bias=True)
          (LayerNorm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
        (cross_attention): MultiHeadAttention(
          (query): Linear(in_features=128, out_features=128, bias=True)
          (key): Linear(in_features=128, out_features=128, bias=True)
          (value): Linear(in_features=128, out_features=128, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (out_linear): Linear(in_features=128, out_features=128, bias=True)
          (LayerNorm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): FeedForward(
          (linear_1): Linear(in_features=128, out_features=512, bias=True)
          (linear_2): Linear(in_features=512, out_features=128, bias=True)
          (LayerNorm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (fourier_attention): FrequencyAttention(
    (freq_proj): Linear(in_features=128, out_features=128, bias=True)
    (dropout): Dropout(p=0.1, inplace=False)
    (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (intra_position_embedding): Embedding(50, 128)
  (intra_transformer): Transformer(
    (layer): ModuleList(
      (0-1): 2 x TransformerLayer(
        (multi_head_attention): MultiHeadAttention(
          (query): Linear(in_features=128, out_features=128, bias=True)
          (key): Linear(in_features=128, out_features=128, bias=True)
          (value): Linear(in_features=128, out_features=128, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.4, inplace=False)
          (out_linear): Linear(in_features=128, out_features=128, bias=True)
          (LayerNorm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.4, inplace=False)
        )
        (feed_forward): FeedForward(
          (linear_1): Linear(in_features=128, out_features=512, bias=True)
          (linear_2): Linear(in_features=512, out_features=128, bias=True)
          (LayerNorm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.4, inplace=False)
        )
      )
    )
  )
  (intra_layer_norm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
  (intra_dropout): Dropout(p=0.4, inplace=False)
  (inter_lstm): LSTM(128, 64, batch_first=True, bidirectional=True)
  (inter_layer_norm): LayerNorm((128,), eps=1e-12, elementwise_affine=True)
  (inter_dropout): Dropout(p=0.4, inplace=False)
  (session_position_embedding): Embedding(50, 128)
  (session_attention_w): Linear(in_features=256, out_features=128, bias=True)
  (session_attention_v): Linear(in_features=128, out_features=1, bias=False)
  (residual_gate): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): Sigmoid()
  )
  (loss_fct): CrossEntropyLoss()
)
Mon 19 Jan 2026 03:00:45 INFO  [Epoch 0] training [time: 1505.81s, loss: 11.2714, mlm_loss: 6.8687, rec_loss: 9.3994, cl_loss: 1.2456, ]
Mon 19 Jan 2026 03:02:08 INFO  [Epoch 0] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 03:02:08 INFO  [Epoch 0] Val Result: {'recall@5': 0.023497106992252624, 'ndcg@5': 0.015027830284390248, 'recall@10': 0.03822692948906541, 'ndcg@10': 0.019778278510079753}
Mon 19 Jan 2026 03:26:59 INFO  [Epoch 1] training [time: 1491.32s, loss: 10.2563, mlm_loss: 5.7659, rec_loss: 8.9115, cl_loss: 0.4791, ]
Mon 19 Jan 2026 03:28:22 INFO  [Epoch 1] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 03:28:22 INFO  [Epoch 1] Val Result: {'recall@5': 0.026831421006178288, 'ndcg@5': 0.017332858429406805, 'recall@10': 0.04234578797685594, 'ndcg@10': 0.02233291449202642}
Mon 19 Jan 2026 03:53:32 INFO  [Epoch 2] training [time: 1509.83s, loss: 10.0048, mlm_loss: 5.4882, rec_loss: 8.7363, cl_loss: 0.4272, ]
Mon 19 Jan 2026 03:54:53 INFO  [Epoch 2] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 03:54:53 INFO  [Epoch 2] Val Result: {'recall@5': 0.02836128273021477, 'ndcg@5': 0.018255309619844645, 'recall@10': 0.04619005589879376, 'ndcg@10': 0.023978567434383674}
Mon 19 Jan 2026 04:19:36 INFO  [Epoch 3] training [time: 1482.66s, loss: 9.8564, mlm_loss: 5.3345, rec_loss: 8.6317, cl_loss: 0.3944, ]
Mon 19 Jan 2026 04:20:54 INFO  [Epoch 3] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 04:20:54 INFO  [Epoch 3] Val Result: {'recall@5': 0.030361871138570168, 'ndcg@5': 0.019502673328443052, 'recall@10': 0.048700598215161324, 'ndcg@10': 0.025407970859991098}
Mon 19 Jan 2026 04:45:49 INFO  [Epoch 4] training [time: 1495.13s, loss: 9.7536, mlm_loss: 5.2286, rec_loss: 8.5585, cl_loss: 0.3737, ]
Mon 19 Jan 2026 04:47:10 INFO  [Epoch 4] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 04:47:10 INFO  [Epoch 4] Val Result: {'recall@5': 0.03204864175737962, 'ndcg@5': 0.02051519797960543, 'recall@10': 0.049857801314111994, 'ndcg@10': 0.026269003691901948}
Mon 19 Jan 2026 05:11:53 INFO  [Epoch 5] training [time: 1482.67s, loss: 9.6727, mlm_loss: 5.1586, rec_loss: 8.4963, cl_loss: 0.3617, ]
Mon 19 Jan 2026 05:13:15 INFO  [Epoch 5] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 05:13:15 INFO  [Epoch 5] Val Result: {'recall@5': 0.033460821810336376, 'ndcg@5': 0.021455211230583186, 'recall@10': 0.052446798077866036, 'ndcg@10': 0.027559449114588602}
Mon 19 Jan 2026 05:38:22 INFO  [Epoch 6] training [time: 1506.68s, loss: 9.6104, mlm_loss: 5.1104, rec_loss: 8.4482, cl_loss: 0.3503, ]
Mon 19 Jan 2026 05:39:43 INFO  [Epoch 6] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 05:39:43 INFO  [Epoch 6] Val Result: {'recall@5': 0.03395116210650191, 'ndcg@5': 0.021594940278651, 'recall@10': 0.053427478670197114, 'ndcg@10': 0.02782754863525496}
Mon 19 Jan 2026 06:04:35 INFO  [Epoch 7] training [time: 1491.96s, loss: 9.5538, mlm_loss: 5.0659, rec_loss: 8.4034, cl_loss: 0.3430, ]
Mon 19 Jan 2026 06:05:56 INFO  [Epoch 7] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 06:05:56 INFO  [Epoch 7] Val Result: {'recall@5': 0.03459841129744042, 'ndcg@5': 0.02226131299120241, 'recall@10': 0.05505540845346671, 'ndcg@10': 0.028824342499530302}
Mon 19 Jan 2026 06:40:22 INFO  [Epoch 8] training [time: 2066.51s, loss: 9.5074, mlm_loss: 5.0270, rec_loss: 8.3669, cl_loss: 0.3378, ]
Mon 19 Jan 2026 06:41:42 INFO  [Epoch 8] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 06:41:42 INFO  [Epoch 8] Val Result: {'recall@5': 0.03532411493576542, 'ndcg@5': 0.02269240611263779, 'recall@10': 0.054780817887614006, 'ndcg@10': 0.028998170944596197}
Mon 19 Jan 2026 07:16:10 INFO  [Epoch 9] training [time: 2068.61s, loss: 9.4610, mlm_loss: 4.9926, rec_loss: 8.3297, cl_loss: 0.3319, ]
Mon 19 Jan 2026 07:19:05 INFO  [Epoch 9] Val Result: {'recall@5': 0.03469647935667353, 'ndcg@5': 0.022029970072058588, 'recall@10': 0.055643816808865355, 'ndcg@10': 0.028781447909071688}
Mon 19 Jan 2026 07:46:16 INFO  [Epoch 10] training [time: 1630.85s, loss: 9.4210, mlm_loss: 4.9613, rec_loss: 8.2978, cl_loss: 0.3274, ]
Mon 19 Jan 2026 07:47:37 INFO  [Epoch 10] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 07:47:37 INFO  [Epoch 10] Val Result: {'recall@5': 0.03614788663332353, 'ndcg@5': 0.022746238098713165, 'recall@10': 0.05642836128273022, 'ndcg@10': 0.02923843455136939}
Mon 19 Jan 2026 08:12:40 INFO  [Epoch 11] training [time: 1503.86s, loss: 9.3894, mlm_loss: 4.9364, rec_loss: 8.2719, cl_loss: 0.3256, ]
Mon 19 Jan 2026 08:14:01 INFO  [Epoch 11] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 08:14:01 INFO  [Epoch 11] Val Result: {'recall@5': 0.03614788663332353, 'ndcg@5': 0.022986488828264384, 'recall@10': 0.056761792684122785, 'ndcg@10': 0.029640794841404042}
Mon 19 Jan 2026 08:39:07 INFO  [Epoch 12] training [time: 1505.14s, loss: 9.3568, mlm_loss: 4.9161, rec_loss: 8.2446, cl_loss: 0.3226, ]
Mon 19 Jan 2026 08:40:27 INFO  [Epoch 12] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 08:40:27 INFO  [Epoch 12] Val Result: {'recall@5': 0.036245954692556634, 'ndcg@5': 0.02313780980015708, 'recall@10': 0.05738942826321467, 'ndcg@10': 0.029947388481366653}
Mon 19 Jan 2026 09:05:28 INFO  [Epoch 13] training [time: 1500.87s, loss: 9.3301, mlm_loss: 4.8982, rec_loss: 8.2219, cl_loss: 0.3212, ]
Mon 19 Jan 2026 09:06:48 INFO  [Epoch 13] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 09:06:48 INFO  [Epoch 13] Val Result: {'recall@5': 0.036128273021476906, 'ndcg@5': 0.0232235135921745, 'recall@10': 0.05735020103952143, 'ndcg@10': 0.030037974792800137}
Mon 19 Jan 2026 09:31:54 INFO  [Epoch 14] training [time: 1506.04s, loss: 9.3052, mlm_loss: 4.8825, rec_loss: 8.2010, cl_loss: 0.3194, ]
Mon 19 Jan 2026 09:33:14 INFO  [Epoch 14] Val Result: {'recall@5': 0.036736294988722176, 'ndcg@5': 0.02330125674986776, 'recall@10': 0.05738942826321467, 'ndcg@10': 0.029953005183639744}
Mon 19 Jan 2026 09:58:16 INFO  [Epoch 15] training [time: 1502.01s, loss: 9.2827, mlm_loss: 4.8694, rec_loss: 8.1829, cl_loss: 0.3149, ]
Mon 19 Jan 2026 09:59:38 INFO  [Epoch 15] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 09:59:38 INFO  [Epoch 15] Val Result: {'recall@5': 0.03622634108071001, 'ndcg@5': 0.02326456159134057, 'recall@10': 0.05866431303324507, 'ndcg@10': 0.03048342402523565}
Mon 19 Jan 2026 10:24:53 INFO  [Epoch 16] training [time: 1515.46s, loss: 9.2624, mlm_loss: 4.8570, rec_loss: 8.1655, cl_loss: 0.3136, ]
Mon 19 Jan 2026 10:26:13 INFO  [Epoch 16] Saving current: ./myckpt/Industrial_and_Scientific/Jan-19-2026_02-35-c0ff2f_mlm0.2_cl0.4_maskratio0.5_drop0.4_dpcross0.1/best_model.pth
Mon 19 Jan 2026 10:26:13 INFO  [Epoch 16] Val Result: {'recall@5': 0.03756006668628028, 'ndcg@5': 0.023967849187691025, 'recall@10': 0.06001765225066196, 'ndcg@10': 0.031209087103526358}
Mon 19 Jan 2026 10:51:14 INFO  [Epoch 17] training [time: 1500.90s, loss: 9.2423, mlm_loss: 4.8469, rec_loss: 8.1482, cl_loss: 0.3117, ]
Mon 19 Jan 2026 10:52:34 INFO  [Epoch 17] Val Result: {'recall@5': 0.03767774835736001, 'ndcg@5': 0.023802155524571177, 'recall@10': 0.060115720309895065, 'ndcg@10': 0.031036847024919285}
Mon 19 Jan 2026 11:17:38 INFO  [Epoch 18] training [time: 1504.02s, loss: 9.2211, mlm_loss: 4.8374, rec_loss: 8.1300, cl_loss: 0.3092, ]
Mon 19 Jan 2026 11:18:58 INFO  [Epoch 18] Val Result: {'recall@5': 0.0373050897322742, 'ndcg@5': 0.02375011365647712, 'recall@10': 0.059821516132195746, 'ndcg@10': 0.03099790472569063}
Mon 19 Jan 2026 11:44:15 INFO  [Epoch 19] training [time: 1517.06s, loss: 9.2049, mlm_loss: 4.8284, rec_loss: 8.1172, cl_loss: 0.3049, ]
Mon 19 Jan 2026 11:45:34 INFO  [Epoch 19] Val Result: {'recall@5': 0.037108953613807984, 'ndcg@5': 0.02370424793785292, 'recall@10': 0.059429243895263315, 'ndcg@10': 0.030881906266515016}
Mon 19 Jan 2026 12:10:52 INFO  [Epoch 20] training [time: 1518.57s, loss: 9.1877, mlm_loss: 4.8225, rec_loss: 8.1012, cl_loss: 0.3051, ]
Mon 19 Jan 2026 12:12:13 INFO  [Epoch 20] Val Result: {'recall@5': 0.03716779444934785, 'ndcg@5': 0.023804486240372187, 'recall@10': 0.05776208688830048, 'ndcg@10': 0.030418657171640884}
Mon 19 Jan 2026 12:37:35 INFO  [Epoch 21] training [time: 1522.33s, loss: 9.1711, mlm_loss: 4.8172, rec_loss: 8.0859, cl_loss: 0.3045, ]
Mon 19 Jan 2026 12:38:56 INFO  [Epoch 21] Val Result: {'recall@5': 0.03742277140335393, 'ndcg@5': 0.023971137507611588, 'recall@10': 0.058821221928018044, 'ndcg@10': 0.030845624201435943}
